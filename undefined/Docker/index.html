<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Docker | F Blog</title><meta name="keywords" content="笔记"><meta name="author" content="Fa"><meta name="copyright" content="Fa"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Docker"><meta name="application-name" content="Docker"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="Docker"><meta property="og:url" content="http://blog.656886.xyz/undefined/Docker/index.html"><meta property="og:site_name" content="F Blog"><meta property="og:description" content="Docker一、docker概述​	docker是一种容器技术，但是容器不仅仅只有docker ​	dotcloud公司开发，2013年开源，2013年底改名docker公司，支持最好的linux版本：ubuntu(14以上)、centos7以上 ​	开发语言：Go语言(谷歌) ​	三大支撑技术：基"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://img01.656886.xyz//docker.jpg"><meta property="article:author" content="Fa"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://img01.656886.xyz//docker.jpg"><meta name="description" content="Docker一、docker概述​	docker是一种容器技术，但是容器不仅仅只有docker ​	dotcloud公司开发，2013年开源，2013年底改名docker公司，支持最好的linux版本：ubuntu(14以上)、centos7以上 ​	开发语言：Go语言(谷歌) ​	三大支撑技术：基"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://blog.656886.xyz/undefined/Docker/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":null},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: Fa","link":"链接: ","source":"来源: F Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'F Blog',
  title: 'Docker',
  postAI: '',
  pageFillDescription: 'Docker, 一、docker概述, 二、实验环境搭建, 三、镜像和容器, 镜像, 容器：, 四、数据卷, 五、容器网络, 六、镜像制作, 七、仓库, 八、docker swarm, 九、docker-compose, 十、docker可视化管理工具, 十一、Kubernetes简介与安装一概述是一种容器技术但是容器不仅仅只有公司开发年开源年底改名公司支持最好的版本以上以上开发语言语言谷歌三大支撑技术基于内核的技术联合分层文件系统来源于采用三大支撑技术建立理念图标集装箱代表镜像大鲸鱼代表仓库镜像是死的需要运行它运行后形态容器广告词版本分为企业版和社区版先有镜像才有容器场景顺序说明常规运行容器镜像容器必须基于已有镜像创建容器构建镜像临时容器新镜像通过临时容器生成镜像但依赖基础镜像存在容器和虚拟机的差异对比容器没有这一层没有所有容器共享操作系统内核轻量级虚拟化减少资源占用传统型的虚拟化优势隔离性好容器的优势轻量简单效率高虚拟机在系统中形态是一台机器容器在系统中是一个进程架构会有一个进程管理镜像容器网络数据卷架构分为服务器端和客户端远程管理接口平台架构服务器客户端镜像容器仓库容器编排平台谷歌公司二实验环境搭建可以联网的情况下可以采用在线安装方式我们采用离线安装包的方式来安装准备一台的虚拟机创建一台虚拟机稍后安装操作系统选择位指定虚拟机的名字和位置核内存网络创建一个新的虚拟磁盘磁盘单个文件删除声卡打印机塞入光盘安装操作系统安装语言英语时区亚洲上海分区分区类型自动分区根分区调大调小接受改变安装模式最小化安装关闭设置密码和普通用户服务器的基本配置主机名主机名解析查看主机名设置主机名主机名主机名解析文件地址默认网卡没有地址因为网卡没有启用重启网络测试网络联通性网关物理机百度由于分配的地址会变化需要固定地址修改配置文件有两个网络管理器一个一个默认最后一个字段不能是不能是不能是修改完后保存重启网络如果物理机可以通百度无法通则是域名解析问题添加关闭防火墙关闭查看防火墙状态关闭防火墙关闭防火墙自启查看状态三种模式默认查看的模式修改模式临时修改修改模式仓库上传包解压解压后多出两个目录保存的是安装包保存的是镜像进入目录删除或移走网络源创建一个本地仓库文件仓库标签仓库名仓库位置启用仓库不做校验验证仓库清空缓存查看仓库列出仓库的所有安装包升级内核以及参数优化升级前内核版本版本查看命令内核版本查看升级内核重启升级后的内核版本注意升级内核之后网络源仓库文件会重新生成需要重新删除加载防火墙模块内核参数优化配置文件加载以上三行安装启动启动验证实验环境服务端客户端命令分为两类管理命令一组直接使用的命令列出当前的镜像管理命令仓库镜像名标签创建时间大小三镜像和容器镜像查看镜像删除镜像镜像名强制删除如果镜像被某个容器使用则不能删除解决删除容器再删除镜像使用选项强制删除删除没有使用的镜像虚悬镜像清空所有镜像获取镜像已经有镜像包可以导入导入镜像镜像包文件从查看中拉取镜像全世界最大的镜像仓库拉取镜像镜像名标签解决办法国内镜像加速容器查看当前的容器列出当前在运行的容器列出所有的容器删除容器容器名如果容器在运行则不能删除清空所有容器删除关闭的容器解决办法先再删除强制删除创建容器选项镜像名命令创建一个交互式容器创建后直接进入到容器中容器名镜像名可以交互分配一个虚拟终端容器名字当容器退出时自动删除容器用于测试指定容器的主机名退出容器退出后容器会关闭创建一个守护式容器创建后没有进入容器容器名镜像名后台运行进入容器后台在运行方式一容器名不推荐问题退出时导致容器被关闭正确的退出方式方式二容器名推荐退出容器不会关闭容器案例使用镜像启动容器选项端口映射宿主机端口容器端口讲端口映射到宿主机随机端口服务端口服务的首页位置修改首页的内容案例显示服务修改后的首页使用镜像启动容器选项端口映射宿主机端口容器端口将容器端口映射到宿主机随机端口服务端口服务的首页位置修改首页的内容容器的生命周期创建容器容器名启动容器容器名停止容器容器名重启容器容器名暂停容器暂停的容器无法进入容器名取消暂停容器名删除容器容器其它使用的命令不进入容器使用一些命令操作容器名获取容器的日志容器名查看容器进程查看容器占用资源情况对象查看对象的底层信息格式的配置信息获取格式化信息四数据卷解决容器中的数据生命周期是依赖于容器的生命周期需要实现数据的持久化脱离容器的生命周期容器与宿主机之间的数据拷贝容器名容器内文件路径拷贝到宿主机的路径容器宿主机宿主机的文件路径容器名容器内文件路径宿主机容器使用数据卷在容器创建时创建卷容器目录与宿主机某个目录绑定分为两类绑定挂载卷同时指定容器中的目录和宿主机中的目录指定挂载卷只指定容器中的目录宿主机目录由指定选项创建容器时创建数据卷容器名使用指定容器的卷创建创建一个指定挂载卷删除创建了数据卷的容器容器名创建一个绑定挂载卷宿主机目录容器目录删除容器后重建新容器同时获取原数据案例创建容器实现服务要求不进入容器中修改主页内容案例容器与容器之间共享数据卷将两个容器的目录与同一宿主机目录绑定即可案例三个容器同时提供服务访问到相同的页面模拟集群负载均衡单独创建卷列出数据卷卷名创建数据卷卷名查看卷的详细信息挂载卷到容器同一个卷可以挂载到不同容器删除卷卷没有使用五容器网络搭建环境后会默认创建一个网桥地址会下发地址给容器创建容器时会创建一对接口一端在宿主机认为连接到接口另一端在容器中非集群环境有三种网络默认列出网络查看网络信息创建一个无网络的容器做数据处理创建网络创建一个新的网桥连接一个容器到网络网络名容器名相当于为容器添加另一个网卡将容器从网络断开网络名容器名删除网络网络名如果网络被容器使用则先删除容器练习创建一个网络网段创建两个容器使用网络创建第三个容器使用网络验证联通性使三个容器可以互通步骤复制终端在另一个窗口打开复制两次进入容器容器查看各个容器用的给添加一块网卡连接到随后进入查看容器的地址回到案例容器互联作用容器与容器之间如果通过地址访问有问题实现的无关性选项链接第一个容器将第二个容器链接到第一个容器要链接的容器名别名进入可以使用别名主机名访问案例联盟式容器容器与容器之间共享同一个网络名称空间创建容器时使用的网络名称空间案例容器与宿主机共享同一个网络名称空间不需要网络地址转换直接使用宿主机的网络空间六镜像制作为什么需要之前所有的容器都是使用别人的镜像创建的有问题别人的镜像未必适用开发人员需要把源代码打包到镜像方式一容器提交为镜像案例将服务的首页的内容打包到镜像中需要拉取原始镜像原始镜像需要使用原始镜像启动一个容器在容器中修改进入容器修改首页容器名容器对镜像所做的修改把容器提交为新的镜像作者镜像信息容器名镜像名将容器提交为镜像镜像名查看镜像的历史信息使用新镜像创建容器进行测试案例制作镜像方式一拉取基础镜像原始镜像使用基础镜像创建一个容器在容器中修改上传和安装包通过将安装包拷贝到容器中安装配置的环境变量编辑添加两行加载检查安装配置环境变量添加两行将容器提交为新的镜像测试镜像的服务端口是启动方式二通过文件来构建镜像创建一个文件夹进入文件夹在文件夹中拉取修改权限编辑文件使用构建镜像测试指令基本镜像第行指定镜像创建者信息邮箱基本镜像所支持的命令容器启动时执行的命令类似指定用户默认用户暴露端口环境变量添加文件类似不同在于可以解压缩可以添加远程文件创建数据卷切换工作目录在子镜像执行的命令案例通过文件构建服务镜像创建一个文件夹并进入文件夹创建一个文件夹并进入文件夹编辑文件基本镜像维护者信息邮箱更新仓库安装修改首页内容暴露端口容器执行的命令构建镜像测试访问七仓库镜像的方式一镜像的导入和导出导出为文件手动拷贝人工携带将容器导出为文件到目标机再导入创建一个容器导出的文件容器名将容器导出为文件文件路径导入后镜像名标签将文件导入为镜像验证镜像的保存和加载保存的文件名镜像名将镜像保存为文件文件名将文件加载为镜像验证方式二建立仓库通过网络来传递镜像镜像的完整表示注册服务器仓库镜像名版本世界上最大的镜像仓库私有仓库阿里云等平台注册后可以建立一个小的个人仓库容量比较小镜像名推送镜像默认是不能推送镜像名改标签后的镜像名为镜像打标签登录阿里云仓库使用注册容器镜像服务管理控制台个人版创建命名空间创建镜像仓库本地仓库登录改标签推送镜像到仓库从仓库拉取镜像私有仓库中国区团队带图形界面创建私有仓库镜像获取创建仓库验证案例模拟公共仓库与私有仓库的联动模拟开发人员从公共仓库拉取镜像镜像启动为容器提交容器为修改后的镜像启动容器修改内容提交容器为新的镜像开发人员将镜像推送到企业私有仓库修改镜像标签修改添加一行推送镜像到私有仓库验证模拟测试人员从私有仓库拉取开发人员推送的镜像做测试私有仓库拉取镜像测试八容器编排平台谷歌社区本身是群集的意思自己将多个装有的聚合成一个大的对外提供统一的服务特点可以平滑切换不需要改动学习成本低轻量级简单与是同一家公司兼容性好架构管理节点管理集群项目经理也可以多个任务调度服务发现工作节点干活程序员多个完成任务启动容器集群整体提供服务搭建规划一个管理节点两个工作节点构建集群管理节点工作节点步骤准备台虚拟机需要修改网卡修改配置文件中的为修改地址删除文件修改重启网络网关和外网百度创建集群在管理节点上执行查看集群中的节点查看网络覆盖性网络作为工作节点加入集群退出集群以管理节点工作节点的身份加入集群删除集群的节点使用部署服务列出服务创建服务任务数服务名镜像名命令服务名查看服务的底层详细信息服务名查看服务的任务调度情况服务名副本数量设置服务的副本数服务名删除服务案例在集群中部署服务创建一个基于的覆盖性网络在集群中创建的服务访问集群中任何节点都可以访问到案例扩展在集群中部署修改了首页的服务启动容器修改首页容器提交为镜像导出镜像为文件可以使用私有仓库解决拷贝文件到工作节点导入镜像访问所有节点都可以访问到九有了镜像就可以通过启动容器或者创建服务在微服务架构中存在问题涉及的服务数量巨多多服务架构的编排工具解决的是多个服务统一的编排和部署通过配置文件进行统一的编排与类似针对的是一个镜像一个容器针对的是多个镜像多个服务下载设置执行权限卸载案例使用部署服务准备两个镜像创建一个目录进入目录创建一个文件编辑文件启动查看列出容器访问宿主机扩展任务在集群上部署部署注意之前的网络要删掉如果某台工作节点无法访问请重启查看查看查看服务查看状态十可视化管理工具对的管理更加直观本地的图形化管理工具需要登录安全性更好安装拉取镜像启动容器访问宿主机十一简介与安装介绍谷歌内部项目系统年开源主要功能自我修复容器崩溃后会自动重启重建保活弹性伸缩自动根据需要调整容器的数量动态扩缩服务发现自动发现所依赖的服务服务自发现负载均衡多个容器可以平均分配资源均衡调度版本回退新版本有自动退回原版本智能回滚存储编排根据需求创建存储卷按需存储组件控制节点集群的管理集群的管理入口计算资源的调度情况负责具体任务的调度存储资源对象的信息工作节点干活工作节点上接受任务负责容器操作复杂的服务的对外访问搭建规划两个节点控制节点工作节点步骤基础环境准备准备两台虚拟机配置虚拟机的主机名和上传文件到目录下解压不要加选项删除网络源个包升级内核配置主机映射配置防火墙及重启再次删除网络源关闭配置时间同步配置路由转发在所有节点执行以下操作配置在所有节点执行以下操作安装所有节点安装启动引擎并设置开机自启安装集群所有节点安装工具并启动安装工具此时启动不成功正常后面初始化的时候会变成功初始化集群登录节点初始化集群若配置错地址需重置集群配置要开始使用集群您需要以普通用户身份运行以下命令配置网络节点加入集群安装使用命令安装检查所有状态输入地址即可访问登录需要输入令牌通过以下命令获取访问的认证令牌配置在浏览器输入地址即可进入的认证界面在文本框中输入令牌后可进入控制台集群测试在部署创建查看暴露端口访问十二资源管理在中一切皆为资源资源容器跑在中控制器管理分为不同的类型提供服务访问存储数据持久化语言类似于的标记性语言强调以数据为中心语法使用缩进表示层级关系缩进空格的个数不重要对其即可表示同一层级表示注释后面加空格数据类型纯量不可再分的值布尔值整数浮点数字符串时间日期',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-05-27 17:01:26',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://img01.656886.xyz/%E5%92%95%E5%92%95.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">F Blog</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 教程TUTORIAL</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 全部文章</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 文章分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 推荐REC</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/%E6%9C%BA%E5%9C%BA%E6%B5%8B%E8%AF%84/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 机场测评</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://ssh.cmliussss.net/"><i class="anzhiyufont anzhiyu-icon-keyboard faa-tada" style="font-size: 0.9em;"></i><span> WebSSH</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 公益服务CSR</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://github.fxxk.dedyn.io/"><i class="anzhiyufont anzhiyu-icon-github faa-tada" style="font-size: 0.9em;"></i><span> GitHub 文件加速</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://ssh.cmliussss.net/"><i class="anzhiyufont anzhiyu-icon-keyboard faa-tada" style="font-size: 0.9em;"></i><span> WebSSH</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://sub.fxxk.dedyn.io/"><i class="anzhiyufont anzhiyu-icon-shuffle faa-tada" style="font-size: 0.9em;"></i><span> 订阅转换</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于F</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-house-chimney faa-tada" style="font-size: 0.9em;"></i><span> About me</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://github.com/Fa277322?tab=repositories"><i class="anzhiyufont anzhiyu-icon-github faa-tada" style="font-size: 0.9em;"></i><span> GitHub仓库</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" alt="微信" src="/null"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="/null"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/%E4%B8%AD%E5%B0%8F%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E6%9E%84%E5%BB%BA/" style="font-size: 1.05rem;">中小企业网络构建<sup>5</sup></a><a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 1.05rem;">笔记<sup>1</sup></a><a href="/tags/%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF/" style="font-size: 1.05rem;">虚拟化技术<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">五月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">十一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/" itemprop="url">笔记</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E7%AC%94%E8%AE%B0/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>笔记</span></a></span></div></div><h1 class="post-title" itemprop="name headline">Docker</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-05-27T16:00:00.000Z" title="发表于 2025-05-28 00:00:00">2025-05-28</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-05-27T09:01:26.296Z" title="更新于 2025-05-27 17:01:26">2025-05-27</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为新加坡"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>新加坡</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://img01.656886.xyz//docker.jpg"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://blog.656886.xyz/undefined/Docker/"><header><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/" itemprop="url">笔记</a><a href="/tags/%E7%AC%94%E8%AE%B0/" tabindex="-1" itemprop="url">笔记</a><h1 id="CrawlerTitle" itemprop="name headline">Docker</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Fa</span><time itemprop="dateCreated datePublished" datetime="2025-05-27T16:00:00.000Z" title="发表于 2025-05-28 00:00:00">2025-05-28</time><time itemprop="dateCreated datePublished" datetime="2025-05-27T09:01:26.296Z" title="更新于 2025-05-27 17:01:26">2025-05-27</time></header><h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><h4 id="一、docker概述"><a href="#一、docker概述" class="headerlink" title="一、docker概述"></a>一、docker概述</h4><p>​	docker是一种容器技术，但是容器不仅仅只有docker</p>
<p>​	dotcloud公司开发，2013年开源，2013年底改名docker公司，支持最好的linux版本：ubuntu(14以上)、centos7以上</p>
<p>​	开发语言：Go语言(谷歌)</p>
<p>​	三大支撑技术：基于内核的cgroup技术、namespace、联合分层文件系统</p>
<p>​	来源于lxc (Linux container)，采用三大支撑技术，建立“build shipi and run”理念</p>
<p>​	docker图标：</p>
<p>​	集装箱：代表镜像—build	大鲸鱼：代表仓库—ship	</p>
<p>​	镜像是死的，需要运行它，运行后形态：容器—run</p>
<p>​	广告词： <font color='red'>build ship and run anyapp anywhere</font></p>
<p>​	版本：分为docker ee （企业版） 和 docker ce （社区版）</p>
<p>​	 <font color='red'>先有镜像才有容器</font></p>
<table>
<thead>
<tr>
<th align="left">场景</th>
<th align="left">顺序</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">常规运行容器</td>
<td align="left"><strong>镜像 → 容器</strong></td>
<td align="left">必须基于已有镜像创建容器。</td>
</tr>
<tr>
<td align="left">构建镜像</td>
<td align="left"><strong>临时容器 → 新镜像</strong></td>
<td align="left">通过临时容器生成镜像，但依赖基础镜像存在。</td>
</tr>
</tbody></table>
<p>​	</p>
<p>​	容器和虚拟机的差异对比：</p>
<p>​	容器没有hypervisor这一层，没有guestos，所有容器共享操作系统内核，轻量级虚拟化，减少资源占用！！！</p>
<p>​	传统型的虚拟化优势：隔离性好</p>
<p>​	容器的优势：轻量、简单、效率高</p>
<p>​	虚拟机在系统中形态是一台机器，容器在系统中是一个进程</p>
<p>​	docker架构：</p>
<p>​	会有一个docker daemon进程，管理镜像(image)、容器(containers)、网络(network)、数据卷(data volume)</p>
<p>​	c&#x2F;s架构，分为服务器端和客户端，远程管理rest api接口</p>
<p>​	docker平台架构：</p>
<p>​	服务器、客户端、镜像、容器、仓库</p>
<p>​	容器编排平台：</p>
<table>
<thead>
<tr>
<th align="left">kubernetes(k8s)</th>
<th align="center">谷歌</th>
</tr>
</thead>
<tbody><tr>
<td align="left">mesos</td>
<td align="center">apache</td>
</tr>
<tr>
<td align="left">docker swarm</td>
<td align="center">docker公司</td>
</tr>
</tbody></table>
<h4 id="二、实验环境搭建"><a href="#二、实验环境搭建" class="headerlink" title="二、实验环境搭建"></a>二、实验环境搭建</h4><p>​	1、可以联网的情况下，可以采用在线安装方式</p>
<p>​	2、我们采用离线安装包的方式来安装</p>
<p>​		(1)	准备一台centos的虚拟机</p>
<p>​			创建一台虚拟机—- 稍后安装操作系统—- 选择centos7 64位 —- 指定虚拟机的名字和位置—- cpu1 2核 —- 内存：2G —- 网络：NAT —- 创建一个新的虚拟磁盘—- 磁盘：80G 单个文件—-删除声卡、打印机—- 塞入光盘centos7-1511.iso</p>
<p>​			安装操作系统—- 安装语言：英语—- 时区：亚洲上海—- 分区：I will configure partation —- 分区类型：lvm 自动分区—-&#x2F;根分区调大	&#x2F;home调小—-接受改变—-安装模式：最小化安装—-kdump关闭—-设置root密码和普通用户</p>
<p>​	(2) 服务器的基本配置</p>
<p>​		1)主机名、主机名解析</p>
<p>​			查看主机名	hostname			设置主机名	hostnamectl set-hostname 主机名</p>
<p>​			主机名解析文件： &#x2F;etc&#x2F;hostname</p>
<p>​		2)ip地址</p>
<p>​			默认网卡 eno16777736 没有ip地址，因为网卡没有启用</p>
<p>​			vi &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-eno16777736 <font color='red'>ONBOOT&#x3D;yes</font>	重启网络</p>
<p>​			测试网络联通性：</p>
<p>​					ping网关	ping物理机	ping百度</p>
<p>​			由于dhcp分配的地址会变化，需要固定ip地址，修改配置文件&#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-eno16777736</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BOOTPROTO=dhcp==&gt;static</span><br><span class="line">centos7有两个网络管理器，一个network，一个NetworkManager(默认)</span><br><span class="line">NM_CONTROLED=no</span><br><span class="line">IPADDR=192.168.200.191	(最后一个字段不能是0，不能是1，不能是2)</span><br><span class="line">PREFIX=24(NETMASK=255.255.255.0)</span><br><span class="line">GATEWAY=192.168.200.2</span><br></pre></td></tr></table></figure>

<p>​			修改完后保存，重启网络，如果物理机可以ping通，百度无法ping通，则是域名解析问题</p>
<p>​			vi &#x2F;etc&#x2F;resolv.conf</p>
<p>​			添加 nameserver 192.168.200.2</p>
<p>​		3)关闭防火墙、关闭selinux</p>
<p>​			systemctl status firewalld		—查看防火墙状态</p>
<p>​			systemctl stop firewalld   		—关闭防火墙</p>
<p>​			systemctl disable firewalld  	—关闭防火墙自启</p>
<p>​			iptables -L	—查看状态</p>
<p>​			selinux—三种模式：enforcing(默认)、permissiver、disabled</p>
<p>​			getenforce	   —查看selinux的模式</p>
<p>​			setenforce 0	—修改selinux模式，临时修改</p>
<p>​			vi &#x2F;etc&#x2F;sysconfig&#x2F;selinux   修改模式enforcing —-&gt;disabled</p>
<p>​		4)仓库</p>
<p>1、	  上传Docker.tar.gz包</p>
<p>​			解压	tar zxvf Docker.tar.gz，解压后多出两个目录：docker(保存的是安装包)、images(保存的是镜像)</p>
<p>​			进入&#x2F;etc&#x2F;yum.repos.d目录，删除或移走网络源	mkdir bak 、mv C* bak</p>
<p>2、	  创建一个本地仓库文件local.repo</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[docker]			---仓库标签</span><br><span class="line">name=docker			---仓库名</span><br><span class="line">baseurl=file:///root/Docker		---仓库位置</span><br><span class="line">enabled=1			---启用仓库</span><br><span class="line">gpgcheck=0			---不做校验</span><br></pre></td></tr></table></figure>



<p>验证仓库：</p>
<p>yum clean all		—清空缓存</p>
<p>yum repo list		—查看仓库		</p>
<p>yum list —列出仓库的所有安装包</p>
<p>3、升级内核，以及参数优化</p>
<p>​	升级前内核版本：3.10.0-327.el7.x86_64		版本查看命令：cat &#x2F;etc&#x2F;os-release 内核版本查看：uname -a</p>
<p>​	yum upgrade -y	升级内核</p>
<p>​	reboot重启</p>
<p>​	升级后的内核版本：3.10.0-1062.7.1.el7.x86_64</p>
<p>​	注意：升级内核之后，网络源仓库文件会重新生成，需要重新删除(rm -f Cent*)</p>
<p>​	加载防火墙模块		<font color='red'>modprobe br_netfilter</font></p>
<p>​	vi &#x2F;etc&#x2F;sysctl.conf	内核参数优化配置文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">net.ipv4.ip_forward = 1</span><br><span class="line">net.bridge.bridge-nf-call-ip6tables = 1</span><br><span class="line">net.bridge.bridge-nf-call-iptables = 1</span><br></pre></td></tr></table></figure>

<p>​	sysctl -p 加载以上三行</p>
<p>4、安装启动docker</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install docker-ce docker-ce-cli containerd-io -y</span><br></pre></td></tr></table></figure>

<p>​		启动Docker：	systemctl start docker</p>
<p>​									systemctl enable docker</p>
<p>​		验证实验环境：</p>
<p>​					Docker服务端：systemctl status docker</p>
<p>​					Docker客户端：docker –help　</p>
<p>docker命令分为两类：管理命令（一组）、直接使用的命令</p>
<p>docker image ls ——列出当前的镜像（管理命令）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REPOSITORY(仓库镜像名)	TAG(标签)	IMAGE　ID(id)	CREATED(创建时间)	SIZE(大小)</span><br></pre></td></tr></table></figure>



<h4 id="三、镜像和容器"><a href="#三、镜像和容器" class="headerlink" title="三、镜像和容器"></a>三、镜像和容器</h4><h5 id="镜像"><a href="#镜像" class="headerlink" title="镜像:"></a>镜像:</h5><p>​	查看镜像：docker images(docker image ls)</p>
<p>​	删除镜像：docker rmi 镜像名	（-f 强制删除）—–如果镜像被某个容器使用，则不能删除！（解决：1.删除容器再删除镜像 2.使用-f 选项强制删除）</p>
<p>​	删除没有使用的镜像（虚悬镜像）： docker image prune</p>
<p>​	清空所有镜像：&#96; docker rmi docker images -qa&#96;&#96;</p>
<p>​	获取镜像：</p>
<p>​			1)已经有docker镜像包，可以导入</p>
<p>​				导入镜像：docker load -i xxxxx.tar(镜像tar包文件)</p>
<p>​			2)从查看中拉取镜像—— dockerhub	—–	全世界最大的镜像仓库</p>
<p>​				拉取镜像：docker pull	镜像名：标签</p>
<p>​			解决办法：国内镜像加速</p>
<p>​			vi &#x2F;etc&#x2F;docker&#x2F;daemon.json</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;        </span><br><span class="line"></span><br><span class="line">&quot;registry-mirrors&quot;:[&quot;http://hammal.staronearth.win&quot;,&quot;https://ccr.ccs.tencentyun.com&quot;]</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>systemctl daemon-reload</p>
<p>systemctl restart docker</p>
<h5 id="容器："><a href="#容器：" class="headerlink" title="容器："></a>容器：</h5><p>查看当前的容器：	docker ps （列出当前在运行的容器） -a（列出所有的容器）</p>
<p>删除容器：docker rm 容器名（id）—–	如果容器在运行，则不能删除</p>
<p>清空所有容器：docker rm -f ‘docker ps -qa’<br>删除关闭的容器：docker container prune</p>
<p>解决办法：1.先stop再删除	2.-f 强制删除</p>
<p>创建容器：docker run [option 选项]镜像名	[命令]  </p>
<p>创建一个交互式容器:创建后直接进入到容器中</p>
<p>​		docker run -it –name 容器名 镜像名</p>
<p>​		-i：可以交互(interactive)	-t：分配一个虚拟终端(tty)</p>
<p>​		–name:容器名字</p>
<p>​		–rm:  当容器退出时自动删除容器 （用于测试）</p>
<p>​		-h（–hostname）：指定容器的主机名</p>
<p>​		退出容器：exit —- 退出后容器会关闭！！</p>
<p>创建一个守护式容器：创建后没有进入容器</p>
<p>​		docker run -itd –name 容器名 镜像名</p>
<p>​		-d： 后台运行</p>
<p>进入容器：—-后台在运行</p>
<p>方式一：docker attach 容器名 （不推荐）</p>
<p>​	问题：退出时 exit —-导致容器被关闭———-正确的退出方式：ctrl+p、q</p>
<p>方式二：docker exec -it 容器名 &#x2F;bin&#x2F;bash		（推荐）</p>
<p>​	exit退出容器不会关闭容器</p>
<p>案例：</p>
<p>​	使用nginx镜像启动容器：</p>
<p>​	docker run -itd –name webserver -p 80:80 nginx</p>
<p>选项： -p:端口映射	宿主机端口：容器端口</p>
<p>​			-p：讲端口映射到宿主机随机端口</p>
<p>​	nginx服务端口：80</p>
<p>​	nginx服务的首页位置： &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html&#x2F;index.html</p>
<p>​	修改nginx首页的内容 :</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;&lt;h1&gt;hello,i am your first container!!!&lt;/a&gt;&#x27; &gt; index.html </span><br></pre></td></tr></table></figure>



<p>案例：显示nginx服务修改后的首页:<br>                  使用nginx镜像启动容器：<br>                   docker  run  -itd  –name  webserver -p 80:80  nginx<br>                  选项： -p： 端口映射    宿主机端口：容器端口<br>                               -P： 将容器端口映射到宿主机随机端口<br>                   nginx服务端口： 80<br>                   nginx服务的首页位置：  &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html&#x2F;index.html<br>                   修改nginx首页的内容  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;&lt;h1&gt;hello, i am your first container!!!&lt;/h1&gt;&#x27; &gt; index.html </span><br></pre></td></tr></table></figure>

<p>容器的生命周期：</p>
<p>​	docker run						   ——创建容器</p>
<p>​	docker start 容器名			——启动容器</p>
<p>​	docker stop 容器名			——停止容器</p>
<p>​	docker restart 容器名		——重启容器</p>
<p>​	docker pasue 容器名		 ——暂停容器(暂停的容器无法进入)</p>
<p>​	docker unpause 容器名	——取消暂停</p>
<p>​	docker rm 容器名			   ——删除容器</p>
<p>容器其它使用的命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker exec	------	不进入容器，使用一些命令操作</span><br><span class="line">docker logs -f 容器名	------ 获取容器的日志</span><br><span class="line">docker top 容器名	------ 查看容器进程</span><br><span class="line">docker stats	------查看容器占用资源情况</span><br><span class="line">docker inspect docker对象	------查看docker对象的底层信息（json格式的配置信息）</span><br><span class="line">docker inspect -f &#123;&#123;.NetworkSettings.IPAddress&#125;&#125; webserver ------获取格式化信息</span><br></pre></td></tr></table></figure>

<h4 id="四、数据卷"><a href="#四、数据卷" class="headerlink" title="四、数据卷"></a>四、数据卷</h4><p>​			解决：容器中的数据生命周期是依赖于容器的生命周期，需要实现数据的持久化（脱离容器的生命周期）</p>
<p>​			1.容器与宿主机之间的数据拷贝</p>
<p>​				docker cp 容器名：容器内文件路径	拷贝到	宿主机的路径	—- 容器–&gt;宿主机</p>
<p>​				docker cp 宿主机的文件路径：	容器名：容器内文件路径		—-宿主机–&gt;容器</p>
<p>​			2.使用数据卷</p>
<p>​				bind-mount：在容器创建时创建卷——容器目录与宿主机某个目录“绑定”</p>
<p>​				分为两类：</p>
<p>​				1）绑定挂载卷：同时指定容器中的目录和宿主机中的目录</p>
<p>​				2）docker指定挂载卷：只指定容器中的目录，宿主机目录由docker指定</p>
<p>​				docker run —- 选项</p>
<p>​					-v：创建容器时，创建数据卷</p>
<p>​					–volume-from 容器名：使用指定容器的卷</p>
<p>​					–mount：创建</p>
<p>​				docker run -it –name c1 -v &#x2F;wjfdata busybox ：创建一个docker指定挂载卷</p>
<p>​				docker inspect c1：</p>
<pre><code>            &quot;Mounts&quot;: [
        &#123;
            &quot;Type&quot;: &quot;volume&quot;,
            &quot;Name&quot;: &quot;a2378a97ca0ec91ed0e73382c8dcac4cb9fab4329de15120d45e8997a811d43e&quot;,
            &quot;Source&quot;: &quot;/var/lib/docker/volumes/a2378a97ca0ec91ed0e73382c8dcac4cb9fab4329de15120d45e8997a811d43e/_data&quot;,
            &quot;Destination&quot;: &quot;/wjfdata&quot;,
            &quot;Driver&quot;: &quot;local&quot;,
            &quot;Mode&quot;: &quot;&quot;,
            &quot;RW&quot;: true,
            &quot;Propagation&quot;: &quot;&quot;
        &#125;
    ],
</code></pre>
<p>​			删除创建了数据卷的容器：docker rm -vf 容器名</p>
<p>​			docker run -it –name c1 -v &#x2F;data&#x2F;volume&#x2F;c1:&#x2F;wjfdata busybox ：创建一个绑定挂载卷(宿主机目录：容器目录)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&quot;Mounts&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;Type&quot;: &quot;bind&quot;,</span><br><span class="line">            &quot;Source&quot;: &quot;/data/volueme/c1&quot;,</span><br><span class="line">            &quot;Destination&quot;: &quot;/wjfdata&quot;,</span><br><span class="line">            &quot;Mode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;RW&quot;: true,</span><br><span class="line">            &quot;Propagation&quot;: &quot;rprivate&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br></pre></td></tr></table></figure>

<p>​		删除容器后，重建新容器同时获取原数据</p>
<p>​		docker run -it –name c2 -v &#x2F;data&#x2F;volume&#x2F;c1:&#x2F;wjfdata busybox</p>
<p>​		案例1：创建容器实现nginx服务，要求不进入容器中，修改主页内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir /root/html</span><br><span class="line">docker run -itd --name wjf1 -p 80:80 -v /root/html:/usr/share/nginx/html nginx</span><br><span class="line">echo &#x27;Hello,World!&#x27; &gt; /root/html/index.html</span><br></pre></td></tr></table></figure>

<p>​		案例2：容器与容器之间共享数据卷：将两个容器的目录与同一宿主机目录绑定即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --name test1 -v /data/volume/test1:/data busybox</span><br><span class="line">docker run -it --name test2 -v /data/volume/test1:/wjfdata centos</span><br></pre></td></tr></table></figure>

<p>​		案例3：三个容器同时提供nginx服务，访问到相同的页面（模拟集群，负载均衡）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --name web1 -p 81:80 -v /usr/share/nginx/html nginx</span><br><span class="line">docker run -itd --name web2 -p 82:80 --volumes-from web1 nginx</span><br><span class="line">docker run -itd --name web3 -p 83:80 --volumes-from web1 nginx</span><br><span class="line">docker exec -it web1 bash</span><br><span class="line">cd /usr/share/nginx/html/</span><br><span class="line">echo &#x27;hello,i am web1&#x27; &gt; index.html</span><br></pre></td></tr></table></figure>



<p>​	volume：单独创建卷</p>
<p>​		dockerr volume ls 						—— 列出数据卷</p>
<p>​		docker volume create 卷名 		——创建数据卷</p>
<p>​		docker  volume  inspect   卷名   ——查看卷的详细信息</p>
<p>​		docker run -it –name c1 –mount source&#x3D;myvol,target&#x3D;&#x2F;jxdata busybox   																——挂载卷到容器</p>
<p>​		docker run -it –name c3 –mount source&#x3D;myvol,target&#x3D;&#x2F;data busybox —																——同一个卷可以挂载到不同容器</p>
<p>​		docker volume rm myvol（docker  volume  prune）  </p>
<p>​																——删除卷（卷没有使用）</p>
<h4 id="五、容器网络"><a href="#五、容器网络" class="headerlink" title="五、容器网络"></a>五、容器网络</h4><p>​	搭建环境后，会默认创建一个网桥docker0，ip地址172.17.0.1&#x2F;16，会下发ip地址给容器，172.17.0.2&#x2F;16,172.17.0.3&#x2F;16</p>
<p>​	创建容器时，会创建一对接口，一端在宿主机（认为连接到docker0，接口vethXXX），另一端在容器中eth0</p>
<p>​	非集群环境有三种网络：bridge（默认）、host、none</p>
<p>​	列出网络：docker network ls</p>
<p>​	查看网络信息：docker network inspect bridge</p>
<p>​	创建一个无网络的容器：docker run -it –name c3 –network none busybox（做数据处理）</p>
<p>​	创建网络：docker network create -d bridge testnetwork	——创建一个新的网桥</p>
<p>​	连接一个容器到网络：docker network connect 网络名 容器名 ——相当于为容器添加另一个网卡</p>
<p>​	将容器从网络断开：docker network disconnecte 网络名 容器名</p>
<p>​	删除网络：docker  network rm 网络名（docker network prune） 如果网络被容器使用，则先删除容器</p>
<p>​	练习：</p>
<p>​	创建一个网络：wjf-net，网段：10.0.0.0&#x2F;16</p>
<p>​	创建两个容器：con1、con2	——使用bridge网络</p>
<p>​	创建第三个容器：con3	——使用wjf-net网络</p>
<p>​	验证联通性：使三个容器可以互通</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">步骤：</span><br><span class="line">docker network create --driver bridge --subnet 10.0.0.0/16 xxx-net</span><br><span class="line">docker run -itd --name con1 --network bridge busybox</span><br><span class="line">docker run -itd --name con2 --network bridge busybox</span><br><span class="line">docker run -itd --name con3 --network xxx-net busybox</span><br><span class="line"></span><br><span class="line">复制终端在另一个窗口打开（复制两次）：</span><br><span class="line">进入容器：docker exec -it 容器id /bin/sh</span><br><span class="line">查看各个容器ip： ip ad</span><br><span class="line">用con1 ping con2的ip</span><br><span class="line">docker network connect bridge con3 给con3添加一块网卡连接到bridge</span><br><span class="line">随后进入con3查看con3容器的ip地址</span><br><span class="line">回到con1 ping con2 ，ping con3</span><br></pre></td></tr></table></figure>

<p>​	案例1：容器互联</p>
<p>​	作用：容器与容器之间如果通过ip地址访问有问题，实现ip的无关性！！！</p>
<p>​	docker run 选项：</p>
<p>​		–link 链接</p>
<p>​	docker run -itd –name host1 centos 第一个容器</p>
<p>​	docker run -itd –name host2 –link host1:brother centos 将第二个容器链接到第一个容器 —— 要链接的容器名：别名</p>
<p>​	进入host2，可以使用别名（主机名）访问host1</p>
<p>​	案例2：联盟式容器</p>
<p>​		容器与容器之间共享同一个网络名称空间</p>
<p>​		docker run -it –name c2 –network container:c1 busybox	创建容器c2时使用c1的网络名称空间</p>
<p>​		c1:		&#x2F;# echo ‘hello,i am c1 container’ &gt; &#x2F;tmp&#x2F;index.html</p>
<p>​					 &#x2F;# httpd -h &#x2F;tmp</p>
<p>​		c2:	    &#x2F;# wget -O –q 127.0.0.1</p>
<p>​	案例3：容器与宿主机共享同一个网络名称空间</p>
<p>​				docker run -it –name c3 –network host busybox</p>
<p>​				不需要网络地址转换，直接使用宿主机的网络空间</p>
<h4 id="六、镜像制作"><a href="#六、镜像制作" class="headerlink" title="六、镜像制作"></a>六、镜像制作</h4><p>​	为什么需要？	——之前所有的容器都是使用别人的镜像创建的，有问题？</p>
<p>​	1）别人的镜像未必适用</p>
<p>​	2）开发人员，需要把源代码打包到镜像</p>
<p>​	方式一：容器提交为镜像		——docker commit</p>
<p>​	案例：将nginx服务的首页的内容打包到镜像中</p>
<p>​	1.需要拉取原始镜像—nginx原始镜像</p>
<p>​	2.需要使用原始镜像启动一个容器</p>
<p>​	docker run -itd –name web -p 80:80 nginx</p>
<p>​	3.在容器中修改</p>
<p>​	进入容器，修改首页</p>
<p>​	docker diff 容器名：容器对镜像所做的修改</p>
<p>​	4.把容器提交为新的镜像</p>
<p>​	docker commit –author 作者 –message 镜像信息	容器名	镜像名：将容器提交为镜像</p>
<p>​	docker history 镜像名：查看镜像的历史信息</p>
<p>​	5.使用新镜像创建容器，进行测试</p>
<p>​	docker run -itd  –name web3 -p 82:80 nginx:v2</p>
<p>​	案例2：制作tomcat镜像</p>
<p>​		方式一：</p>
<p>​			1.拉取基础镜像——centos原始镜像</p>
<p>​			2.使用基础镜像创建一个容器</p>
<p>​				docker run -it –nam mycentos centos</p>
<p>​			3.在容器中修改</p>
<p>​			1）上传jdk和tomcat安装包</p>
<p>​			2）通过docker cp将安装包拷贝到容器中</p>
<p>​					docker cp jdk-8u161-linux-x64.tar.gz mycentos:&#x2F;root</p>
<p>​					docker cp apache-tomcat-7.0.47.tar.gz mycentos:&#x2F;root</p>
<p>​			3）安装jdk</p>
<p>​					tar -zxvf jdk-8u161-linux-x64.tar.gz -C &#x2F;usr&#x2F;local&#x2F;</p>
<p>​			4）配置jdk的环境变量</p>
<p>​			  	编辑&#x2F;etc&#x2F;profile添加两行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">JAVA_HOME=/usr/local/jdk1.8.0_161</span><br><span class="line">export PATH=$JAVA_HOME/bin:$PATH</span><br></pre></td></tr></table></figure>

<p>​					加载：source &#x2F;etc&#x2F;profile</p>
<p>​					检查：java -version</p>
<p>​			5） 安装tomcat</p>
<p>​				tar -zxvf apache-tomcat-7.0.47.tar.gz  -C &#x2F;usr&#x2F;local&#x2F;</p>
<p>​			6）配置tomcat环境变量</p>
<p>​					vi &#x2F;usr&#x2F;local&#x2F;apache-tomcat-7.0.47&#x2F;bin&#x2F;setclasspath.sh</p>
<p>​					添加两行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/local/jdk1.8.0_161</span><br><span class="line">export JRE_HOME=/usr/local/jdk1.8.0_161/jre</span><br></pre></td></tr></table></figure>



<p>​		4.将容器提交为新的镜像</p>
<p>​				docker commit –author “cloud01” –message “my tomcat image” mycentos mytomcat</p>
<p>​		5.测试镜像</p>
<p>​			docker run -itd –name t1 -p 8888:8080 mytomcat （tomcat的服务端口是8080）</p>
<p>​			docker exec t1 &#x2F;usr&#x2F;local&#x2F;apache-tomcat-7.0.47&#x2F;bin&#x2F;startup.sh	启动tomcat</p>
<p>​	方式二：通过Dockerfile文件来构建镜像	—-docker build</p>
<p>​			1.创建一个文件夹，进入文件夹</p>
<p>​			2.在文件夹中拉取hello</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/docker-library/hello-world/raw/refs/heads/master/amd64/hello-world/hello</span><br></pre></td></tr></table></figure>

<p>​			3.修改hello权限					chmod +x hello</p>
<p>​			4.编辑Dockerfile文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">FROM scratch</span><br><span class="line"></span><br><span class="line">COPY hello /</span><br><span class="line"></span><br><span class="line">CMD [“/hello”]</span><br></pre></td></tr></table></figure>

<p>​			5.使用docker build 构建镜像</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t myhello:1.0</span><br></pre></td></tr></table></figure>

<p>​			6.测试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run myhello:1.0 .</span><br></pre></td></tr></table></figure>





<p>Dockerfile指令：	man dockerfile</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">FROM 基本镜像	---第1行</span><br><span class="line">MAINTAINER	  ---指定镜像创建者信息、邮箱</span><br><span class="line">RUN			  ---基本镜像所支持的命令</span><br><span class="line">CMD			  ---容器启动时执行的命令	---类似ENTRYPOINT</span><br><span class="line">USER		  ---指定用户 (默认用户root)</span><br><span class="line">EXPOSE		  ---暴露端口</span><br><span class="line">ENV			  ---环境变量</span><br><span class="line">ADD			  ---添加文件 (类似COPY) 不同在于可以解压缩，可以添加远程文件</span><br><span class="line">VOLUME		  ---创建 数据卷</span><br><span class="line">WORKDIR		  ---切换工作目录</span><br><span class="line">ONBUILD		  ---在子镜像执行的命令</span><br></pre></td></tr></table></figure>



<p>案例2：通过Dockerfile文件构建nginx服务镜像</p>
<p>​	1.创建一个文件夹，并进入文件夹</p>
<p>​	2.创建一个文件夹，并进入文件夹</p>
<p>​	3.编辑Dockerfile文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#Version:0.0.1</span><br><span class="line">FROM ubuntu:14.04								---基本镜像</span><br><span class="line">MAINTAINER James Turnbull &quot;james@example.com&quot;	---维护者信息、邮箱</span><br><span class="line">RUN apt-get update								---更新仓库</span><br><span class="line">apt-get install -y nginx						---安装nginx</span><br><span class="line">RUN echo &#x27;Hi,I am in your containe&#x27; &gt; /usr/share/nginx/html/index.html														--修改首页内容</span><br><span class="line">EXPOSE 80		 								---暴露端口</span><br><span class="line">CMD [&quot;nginx&quot;,&quot;-g&quot;,&quot;daemon off;&quot;]				---容器执行的命令</span><br></pre></td></tr></table></figure>

<p>​	4.构建镜像</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t cloud01/static_web .</span><br></pre></td></tr></table></figure>

<p>​	5.测试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --name web -p 8080:80 cloud01/static_web</span><br></pre></td></tr></table></figure>

<p>​	访问<a target="_blank" rel="noopener" href="http://192.168.200.191/">http://192.168.200.191</a></p>
<h4 id="七、仓库"><a href="#七、仓库" class="headerlink" title="七、仓库"></a>七、仓库</h4><p>​		镜像的ship：</p>
<p>​			方式一：镜像的 导入和导出，导出为文件，手动拷贝，人工携带</p>
<p>​				1）	将容器导出为文件，到目标机再导入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --name c1 alpine	创建一个容器</span><br><span class="line">docker export -o 导出的tar文件 容器名 ---- 将容器导出为tar文件 ---docker export -o export.tar c1</span><br><span class="line">docker import tar 文件路径 导入后镜像名：标签 --- 将tar文件导入为镜像 ---docker import -m &#x27;import test&#x27; export.tar myalpine</span><br><span class="line">docker run -it myalpine sh 验证</span><br></pre></td></tr></table></figure>

<p>​				2）	镜像的保存和加载</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker save -o	保存的tar文件名 镜像名	---将镜像保存为tar文件</span><br><span class="line">docker load -i tar文件名 ---将文件加载为镜像</span><br><span class="line">docker run myhello:1.0	验证</span><br></pre></td></tr></table></figure>

<p>​			方式二：建立仓库，通过网络来传递镜像</p>
<p>​				镜像的完整表示：注册服务器&#x2F;仓库&#x2F;镜像名：版本，世界上最大的镜像仓库：dockerhub — docker.io&#x2F;library&#x2F;mysql:latest</p>
<p>​				私有仓库：</p>
<p>​						dockerhub、阿里云等平台注册后可以建立一个小的个人仓库，容量比较小</p>
<p>​						docker push 镜像名 —推送镜像</p>
<p>​						默认是：	docker.io&#x2F;library&#x2F;mytomcat	：不能推送</p>
<p>​						docker tag 镜像名	改标签后的镜像名	— 为镜像打标签</p>
<p>​						docker login	登录</p>
<p>​				</p>
<p>​				阿里云仓库使用—注册—容器镜像服务—管理控制台—个人版—创建命名空间—创建镜像仓库—本地仓库</p>
<p>登录：docker login –username&#x3D;aliyun3676574592 crpi-hwsvpr2co34f3mnv.cn-guangzhou.personal.cr.aliyuncs.com</p>
<p>改标签：docker tag afa23431513f crpi-hwsvpr2co34f3mnv.cn-guangzhou.personal.cr.aliyuncs.com&#x2F;wjfns_cloud01&#x2F;wjfrepo_cloud01:v1</p>
<p>推送镜像到仓库：docker push crpi-hwsvpr2co34f3mnv.cn-guangzhou.personal.cr.aliyuncs.com&#x2F;wjfns_cloud01&#x2F;wjfrepo_cloud01:v1</p>
<p>从仓库拉取镜像： docker pull crpi-hwsvpr2co34f3mnv.cn-guangzhou.personal.cr.aliyuncs.com&#x2F;wjfns_cloud01&#x2F;wjfrepo_cloud01:v1</p>
<p>私有仓库：（harbor—VMware中国区团队—带图形界面）</p>
<p>​	创建私有仓库：镜像registry	获取registry：</p>
<p>​		1）docker load -i registry.tar </p>
<p>​		2）docker pull registry</p>
<p>​			  docker run -d -v &#x2F;opt&#x2F;registry:&#x2F;var&#x2F;lib&#x2F;registry –restart&#x3D;always –name registry -p 5000:5000 registry 创建仓库</p>
<p>验证：curl <a target="_blank" rel="noopener" href="http://localhost:5000/v2">http://localhost:5000/v2</a></p>
<p>案例：模拟公共仓库与私有仓库的联动</p>
<p>1.模拟开发人员，从公共仓库拉取镜像，镜像启动为容器，提交容器为修改后的镜像</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --name a1 alpine	启动容器，修改内容</span><br><span class="line">docker commit -a &quot;cloud01&quot; -m &quot;dev work&quot; a1 alpinetest 提交容器为新的镜像</span><br></pre></td></tr></table></figure>

<p>2.开发人员将镜像推送到企业私有仓库</p>
<p>​	修改镜像标签：docker tag alpinetest 192.168.200.191:5000&#x2F;alpinetest</p>
<p>​	修改&#x2F;etc&#x2F;docker&#x2F;daemon.json,添加一行”insecure-registries”:[“192.168.200.191:5000”]</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        &quot;registry-mirrors&quot;:[&quot;http://hammal.staronearth.win&quot;,&quot;https://mirror.ccs.tencentyun.com&quot;],</span><br><span class="line">        &quot;insecure-registries&quot;:[&quot;192.168.200.191:5000&quot;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>systemctl daemon-reload</p>
<p>systemctl restart docker</p>
<p>docker push 192.168.200.191:5000&#x2F;alpinetest 推送镜像到私有仓库</p>
<p>验证：curl <a target="_blank" rel="noopener" href="http://192.168.200.191:5000/v2/_catalog">http://192.168.200.191:5000/v2/_catalog</a></p>
<p>3.模拟测试人员，从私有仓库拉取开发人员推送的镜像做测试</p>
<p>​	docker pull 192.168.200.191:5000&#x2F;alpinetest 私有仓库拉取镜像</p>
<p>​	docker run -it 192.168.200.191:5000&#x2F;alpinetest 测试</p>
<h4 id="八、docker-swarm"><a href="#八、docker-swarm" class="headerlink" title="八、docker swarm"></a>八、docker swarm</h4><p>​	容器编排平台：</p>
<p>​			kubernetes	—谷歌</p>
<p>​			mesos	—apache社区</p>
<p>​			swarm（本身是群集的意思）	—docker自己</p>
<p>​		docker swarm：将多个装有docker的docker engine 聚合成一个大的docker engine，对外提供统一的服务</p>
<p>​		docker swarm特点：</p>
<p>​			1.docker engine可以平滑切换，不需要改动</p>
<p>​			2.学习成本低，轻量级，简单</p>
<p>​			3.与docker是同一家公司，兼容性好</p>
<p>​		docker swarm 架构：</p>
<p>​			管理节点（swarm manager）：—	管理集群（项目经理），也可以多个</p>
<p>​					scheduler — 任务调度</p>
<p>​					discovery service  — 服务发现</p>
<p>​			工作节点（swarm worker）：	—	干活 （程序员），多个</p>
<p>​					完成任务	—	启动容器</p>
<p>​					集群整体提供	—	服务（service）</p>
<p>​			docker swarm 搭建：</p>
<p>​				规划：一个管理节点、两个工作节点构建集群</p>
<p>​						管理节点：	192.168.200.191&#x2F;24	manager</p>
<p>​						工作节点：	192.168.200.192&#x2F;24	worker1</p>
<p>​												192.168.200.193&#x2F;24	worker2</p>
<p>步骤：</p>
<p>​	1.准备3台虚拟机</p>
<p>​		1）需要修改网卡 eno16777736 — ens33</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv ifcfg-eno16777736 ifcfg-ens33</span><br></pre></td></tr></table></figure>

<p>​		2）修改配置文件中的NAME、DEVICE为ens33，修改IP地址，删除文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm /etc/udev/rules.d/90-eno-fix.rules</span><br></pre></td></tr></table></figure>

<p>​		3）修改 &#x2F;etc&#x2F;resolv.conf</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nameserver 192.168.200.2</span><br></pre></td></tr></table></figure>

<p>​		4）重启网络ping网关和外网(百度)</p>
<p>2.创建集群</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker swarm init --advertise-addr 192.168.200.191(在管理节点上执行)</span><br><span class="line">docker node ls	----查看集群中的节点</span><br><span class="line">docker network ls ----查看网络---overlay覆盖性网络</span><br><span class="line">docker swarm join --token SWMTKN-1-0qr3ygyif46pe7px50wlnuwu6938bu4suhrodkt6xni123pl0k-dph7cq41s7bmo4qkdgk85kpr9 192.168.200.191:2377 ---作为工作节点加入集群</span><br><span class="line">docker swarm leave ---退出集群</span><br><span class="line">docker swarm join-token worker|manager ---以管理节点/工作节点的身份加入集群</span><br><span class="line">docker node rm r9j5cdbkpil31d6aavm9ub2kw---删除集群的节点</span><br></pre></td></tr></table></figure>



<p>docker swarm 使用：</p>
<p>​		部署服务：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">docker service ls ---列出服务</span><br><span class="line">docker service create --replicas 1 --name helloworld alpine ping docker.com 创建服务</span><br><span class="line">		--replicas 任务数</span><br><span class="line">		--name 服务名</span><br><span class="line">		alpine 镜像名</span><br><span class="line">		ping docker.com 命令</span><br><span class="line">	docker service inspect 服务名 --- 查看服务的底层详细信息</span><br><span class="line">	docker service ps 服务名 ---查看服务的任务调度情况</span><br><span class="line">	docker service scale 服务名=副本数量 --- 设置服务的副本数</span><br><span class="line">	docker service rm 服务名 --- 删除服务</span><br></pre></td></tr></table></figure>



<p>案例：在集群中部署nginx服务</p>
<p>1.创建一个基于overlay的覆盖性网络my-swarm-network</p>
<p>​	docker network create -d overlay –subnet 172.16.0.0&#x2F;24 my-swarm-network</p>
<p>2.在集群中创建nginx的服务</p>
<p>​	docker service create –network my-swarm-network –name my-web -p 8080:80 –replicas 2 nginx</p>
<p>3.访问192.168.200.191:8080、192.168.200.192:8080、192.168.200.193:8080</p>
<p>​	集群中任何节点都可以访问到</p>
<p>案例扩展：在集群中部署修改了首页的nginx服务</p>
<p>​	1.启动容器</p>
<p>​		docker run -itd –name webserver -p 80:80 nginx</p>
<p>​	2.修改首页</p>
<p>​	3.容器提交为镜像</p>
<p>​		docker commit webserver mynginx</p>
<p>​	4.导出镜像为文件		（4-6可以使用私有仓库解决）</p>
<p>​		docker save -o mynginx.tar mynginx</p>
<p>​	5.拷贝文件到工作节点</p>
<p>​		scp mynginx.tar root@worker1:&#x2F;root		scp mynginx.tar root@worker2:&#x2F;root</p>
<p>​	6.导入镜像</p>
<p>​		docker load -i mynginx.tar</p>
<p>​	7.访问192.168.200.191:8080、192.168.200.192:8080、192.168.200.193:8080</p>
<p>​		所有节点都可以访问到hello,i am new page</p>
<p>​		</p>
<h4 id="九、docker-compose"><a href="#九、docker-compose" class="headerlink" title="九、docker-compose"></a>九、docker-compose</h4><p>​		有了镜像，就可以通过docker run 启动容器，或者docker service create 创建服务</p>
<p>​		在微服务架构中，存在问题：涉及的服务数量巨多！</p>
<p>​		docker-compose— 多服务架构的编排工具（解决的是多个服务统一的编排和部署），通过配置文件进行统一的编排		与Dockerfile类似，</p>
<table>
<thead>
<tr>
<th align="left">Dockerfile</th>
<th align="center">针对的是一个镜像一个容器</th>
</tr>
</thead>
<tbody><tr>
<td align="left">docker-compost</td>
<td align="center">针对的是多个镜像多个服务</td>
</tr>
</tbody></table>
<p>下载Docker-compose</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -L https://github.com/docker/compose/releases/download/1.24.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>

<p>设置docker-compose执行权限：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x docker-compose</span><br></pre></td></tr></table></figure>

<p>卸载docker-compose：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>

<p>案例：使用docker-compose部署wordpress服务</p>
<p>1.准备两个镜像</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql:5.7</span><br><span class="line">docker pull wordpress</span><br></pre></td></tr></table></figure>

<p>2.创建一个目录，进入目录，创建一个docker-compose.yml文件</p>
<p>3.编辑docker-compose.yml文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">version: &#x27;3&#x27;</span><br><span class="line">services:</span><br><span class="line">  db:</span><br><span class="line">    image: mysql:5.7</span><br><span class="line">    volumes:</span><br><span class="line">      - db_data:/var/lib/mysql</span><br><span class="line">    restart: always</span><br><span class="line">    environment:</span><br><span class="line">      MYSQL_ROOT_PASSWORD: wordpress</span><br><span class="line">      MYSQL_DATABASE: wordpress</span><br><span class="line">      MYSQL_USER: wordpress</span><br><span class="line">      MYSQL_PASSWORD: wordpress</span><br><span class="line">  wordpress:</span><br><span class="line">    depends_on:</span><br><span class="line">      - db</span><br><span class="line">    image: wordpress:latest</span><br><span class="line">    ports:</span><br><span class="line">      - &quot;8081:80&quot;</span><br><span class="line">    restart: always</span><br><span class="line">    environment:</span><br><span class="line">      WORDPRESS_DB_HOST: db:3306</span><br><span class="line">      WORDPRESS_DB_USER: wordpress</span><br><span class="line">      WORDPRESS_DB_PASSWORD: wordpress</span><br><span class="line">volumes:</span><br><span class="line">  db_data:</span><br></pre></td></tr></table></figure>

<p>4.docker-compose up 启动</p>
<p>​	查看：docker-compose ps			——列出容器</p>
<p>5.访问 			——宿主机ip:8081</p>
<p>扩展任务：docker-compose在集群上部署wordpress</p>
<p>​	docker stack deploy –compose-file docker-compose.yml stack1	—部署</p>
<p>​	注意之前的网络xxx-net要删掉，如果某台工作节点无法访问请重启</p>
<p>​	查看：</p>
<p>​	docker stack ls —查看stack</p>
<p>​	docker stack services stack1	—查看服务</p>
<p>​	docker stack ps stack1	—查看状态</p>
<h4 id="十、docker可视化管理工具"><a href="#十、docker可视化管理工具" class="headerlink" title="十、docker可视化管理工具"></a>十、docker可视化管理工具</h4><p>​	对docker的管理更加直观</p>
<p>​	docker ui —— 本地的图形化管理工具</p>
<p>​	pottainer：需要登录，安全性更好</p>
<p>安装：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.docker pull uifd/ui-for-docker	---拉取镜像</span><br><span class="line">2.docker run -d -p 9001:9000 -v /var/run/docker.sock:/var/run/docker.sock portainer/portainer	---启动容器</span><br></pre></td></tr></table></figure>

<p>访问：宿主机ip:9001</p>
<h4 id="十一、Kubernetes简介与安装"><a href="#十一、Kubernetes简介与安装" class="headerlink" title="十一、Kubernetes简介与安装"></a>十一、Kubernetes简介与安装</h4><p>介绍：谷歌内部项目borg系统——2015年开源</p>
<p>主要功能：</p>
<p>​	自我修复——容器崩溃后会自动重启、重建(保活)</p>
<p>​	弹性伸缩——自动根据需要调整容器的数量(动态扩缩)</p>
<p>​	服务发现——自动发现所依赖的服务(服务自发现)</p>
<p>​	负载均衡——多个容器可以平均分配资源(均衡调度)</p>
<p>​	版本回退——新版本有bug自动退回原版本(智能回滚)</p>
<p>​	存储编排——根据需求创建存储卷(按需存储)</p>
<p>Kubernetes组件：</p>
<table>
<thead>
<tr>
<th>控制节点(master)</th>
<th align="center">集群的管理</th>
</tr>
</thead>
<tbody><tr>
<td>Apiserver</td>
<td align="center">集群的管理入口</td>
</tr>
<tr>
<td>Scheduler</td>
<td align="center">计算资源的调度情况</td>
</tr>
<tr>
<td>Controller-manger</td>
<td align="center">负责具体任务的调度</td>
</tr>
<tr>
<td>etcd</td>
<td align="center">存储资源对象的信息</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>工作节点(node)</th>
<th align="center">干活</th>
</tr>
</thead>
<tbody><tr>
<td>Kubelet</td>
<td align="center">工作节点上接受任务</td>
</tr>
<tr>
<td>docker</td>
<td align="center">负责容器操作</td>
</tr>
<tr>
<td>kubeporxy</td>
<td align="center">复杂的服务的对外访问</td>
</tr>
</tbody></table>
<p>Kubernetes搭建规划：</p>
<p>​	两个节点：</p>
<p>​		master		控制节点	ip：192.168.200.210&#x2F;24<br>​		node			工作节点	ip：192.168.200.211&#x2F;24</p>
<p>​	步骤：</p>
<p>​		基础环境准备：</p>
<p>​		1、准备两台虚拟机</p>
<p>​		2、配置虚拟机的主机名和IP</p>
<p>​		3、上传k8s.tar文件到&#x2F;root目录下</p>
<p>​		4、解压，不要加-z选项		tar xvf K8S.tar</p>
<p>​		5、删除网络源——463个包	</p>
<p>​				cd &#x2F;etc&#x2F;yum.repo.d</p>
<p>​				mkdir bak mv C*bak<br>​				vi local.repo</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[kubernetes]</span><br><span class="line">name=kubernetes</span><br><span class="line">baseurl=file:///root/Kubernetes</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br></pre></td></tr></table></figure>

<p>​				yum clean all</p>
<p>​				yum repolist</p>
<p>​				yum upgrade -y</p>
<p>​			6、升级内核</p>
<p>​			7、配置主机映射</p>
<p>​			8、配置防火墙及SELinux，重启(再次删除网络源)</p>
<p>​			9、关闭Swap</p>
<p>sed -i “s&#x2F;/dev/mapper/centos-swap&#x2F;#/dev/dev/mapper/centos-swap&#x2F;g” &#x2F;etc&#x2F;fstab</p>
<p>​			10、配置时间同步</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;s/^server/#&amp;/&#x27; /etc/chrony.conf</span><br><span class="line">cat &gt;&gt;/etc//chrony.conf&lt;&lt;EOF</span><br><span class="line">local stratum 10</span><br><span class="line">server master iburst</span><br><span class="line">allow all</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">systemctl enable chronyd &amp;&amp; systemctl restart chronyd</span><br><span class="line">timedatectl set-ntp true</span><br><span class="line">chronyc sources</span><br></pre></td></tr></table></figure>



<p>​			11、配置路由转发</p>
<p>在所有节点执行以下操作：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt; EOF | tee /etc/sysctl.d/K8S.conf</span><br><span class="line">net.ipv4.ip_forward=1</span><br><span class="line">net.bridge.bridge-nf-call-ip6ttables = 1</span><br><span class="line">net.bridge.bridge-nf-call-iptables = 1</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">modprobe br_netfilter</span><br><span class="line">sysctl -p /etc/sysctl.d/K8S.conf</span><br></pre></td></tr></table></figure>

<p>​				12、配置IPVS</p>
<p>在所有节点执行以下操作：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; /etc/sysconfig/modules/ipvs.modules &lt;&lt;EOF</span><br><span class="line">#!/bin/bash</span><br><span class="line">modprobe --ip_vs</span><br><span class="line">modprobe --ip_vs_rr</span><br><span class="line">modprobe --ip_vs_wrr</span><br><span class="line">modprobe --ip_vs_sh</span><br><span class="line">modprobe --nf_conntrack_ipv4</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">chmod 755 /etc/sysconfig/modules/ipvs.modules</span><br><span class="line">bash /etc/sysconfig/modules/ipvs.modules &amp;&amp; lsmod | grep -e ip_vs -e nf_conntrack_ipv4</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsmod | grep -e ip_vs -e nf_conntrack_ipv4</span><br></pre></td></tr></table></figure>

<p> yum install -y yum-utils device-mapper-persistent-data lvm2</p>
<p>yum install docker-ce-18.09.6 docker-ce-cli-18.09.6 containerd.io -y</p>
<p>systemctl daemon-reload</p>
<p>systemctl restart docker</p>
<p>systemctl enable docker</p>
<p>​				13、安装Docker</p>
<p>​						所有节点安装Docker，启动Docker引擎并设置开机自启。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class="line"># yum install docker-ce-18.09.6 docker-ce-cli-18.09.6 containerd.io -y</span><br><span class="line"># mkdir -p /etc/docker</span><br><span class="line"># tee /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line"># systemctl daemon-reload</span><br><span class="line"># systemctl restart docker</span><br><span class="line"># systemctl enable docker</span><br><span class="line"># ./kubernetes_base.sh</span><br><span class="line"></span><br><span class="line"># docker info |grep Cgroup</span><br><span class="line"> Cgroup Driver: system</span><br></pre></td></tr></table></figure>

<p>​				14、安装Kubernetes集群			</p>
<p>​						所有节点安装Kubernetes工具并启动Kubelet。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">（1）安装工具</span><br><span class="line"># yum install -y kubelet-1.14.1 kubeadm-1.14.1 kubectl-1.14.1</span><br><span class="line"># systemctl enable kubelet &amp;&amp; systemctl start kubelet</span><br><span class="line">// 此时启动不成功正常，后面初始化的时候会变成功</span><br><span class="line">（2）初始化Kubernetes集群</span><br><span class="line">登录Master节点，初始化Kubernetes集群。</span><br><span class="line">kubeadm init --apiserver-advertise-address 192.168.200.210 --kubernetes-version=&quot;v1.14.1&quot; --pod-network-cidr=10.16.0.0/16 --image-repository=registry.aliyuncs.com/google_containers</span><br><span class="line">///若配置错IP地址需重置 kubeadm 集群配置:kubeadm reset -f</span><br><span class="line"></span><br><span class="line">要开始使用集群，您需要以普通用户身份运行以下命令：</span><br><span class="line">mkdir -p $HOME/.kube</span><br><span class="line">sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span><br><span class="line">sudo chown $(id -u):$(id -g) $HOME/.kube/config</span><br><span class="line">配置Kubernetes网络</span><br><span class="line">kubectl apply -f yaml/kube-flannel.yaml</span><br><span class="line">Node节点加入集群</span><br><span class="line">kubeadm join 192.168.200.210:6443 --token 7dmbm3.xk406p0d3j29yuq5 \</span><br><span class="line">    --discovery-token-ca-cert-hash sha256:922f82bff830208eff14f026697414f546c9b7f6586916e7b5fce79f38279021</span><br><span class="line">安装Dashboard	：使用kubectl apply命令安装Dashboard</span><br><span class="line">kubectl apply -f yaml/kubernetes-dashboard.yaml</span><br><span class="line">kubectl create -f yaml/dashboard-a	dminuser.yaml</span><br><span class="line">检查所有Pod状态</span><br><span class="line">kubectl get pods -n kube-system</span><br><span class="line">输入地址（https://192.168.200.210:30000），即可访问Kubernetes Dashboard</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">登录Kubernetes Dasboard需要输入令牌，通过以下命令获取访问Dashboard的认证令牌</span><br><span class="line">[root@master ~]# kubectl -n kube-system describe secret $(kubectl -n kube-system get secret | grep kubernetes-dashboard-admin-token | awk &#x27;&#123;print $1&#125;&#x27;)</span><br><span class="line">Name:         kubernetes-dashboard-admin-token-x9xc2</span><br><span class="line">Namespace:    kube-system</span><br><span class="line">Labels:       &lt;none&gt;</span><br><span class="line">Annotations:  kubernetes.io/service-account.name: kubernetes-dashboard-admin</span><br><span class="line">              kubernetes.io/service-account.uid: ee541c31-3630-11f0-b9da-000c29ee48c5</span><br><span class="line"></span><br><span class="line">Type:  kubernetes.io/service-account-token</span><br><span class="line"></span><br><span class="line">Data</span><br><span class="line">====</span><br><span class="line">namespace:  11 bytes</span><br><span class="line">token:      eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJrdWJlcm5ldGVzLWRhc2hib2FyZC1hZG1pbi10b2tlbi14OXhjMiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50Lm5hbWUiOiJrdWJlcm5ldGVzLWRhc2hib2FyZC1hZG1pbiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6ImVlNTQxYzMxLTM2MzAtMTFmMC1iOWRhLTAwMGMyOWVlNDhjNSIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDprdWJlLXN5c3RlbTprdWJlcm5ldGVzLWRhc2hib2FyZC1hZG1pbiJ9.Oprys3U-tADUp4W73-S4F3toMGcYCkAiTm41TYHcRMutNG1Uln1ojyduQXFuHFPNWDvawPnQE2Z6VPRvDrXTLBdzf_McFG_dO_BNm4r6WDiVT8Kdtj3lMzfVlBpMxv4ONFrud_RrxRZ84QOOXYy3nTbEoZNm_jCsljcEkmA5v9XJeHn0nYi6Tf_BnHzfyitYGFUAAju84H3E6LEK0nwUJWfwGOzED-QUJmS71gGN88bpE5FOlOFI-Ln66Iqhv9UnA5uMXZ_aScrBy27IFQOPuo_C2z2b7eFCbG_r-3TgATN6Frj1EIwhX9WHgzX3STIvWUDBYOTUzpr6OKtK7SZLXg</span><br><span class="line">ca.crt:     1025 bytes</span><br></pre></td></tr></table></figure>

<p>配置Kuboard</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# kubectl create -f yaml/kuboard.yaml </span><br><span class="line">在浏览器输入地址http://192.168.200.210:31000，即可进入Kuboard的认证界面，在Token文本框中输入令牌后可进入Kuboard控制台</span><br></pre></td></tr></table></figure>

<p>集群测试：在kubernets部署nginx</p>
<p>kubectl create deploy nginx –image&#x3D;nginx:1.14-alpine	—创建</p>
<p>kubectl get pod		—查看</p>
<p>kubectl expose deployment nginx –port&#x3D;80 –type&#x3D;NodePort	—暴露端口</p>
<p><a target="_blank" rel="noopener" href="http://192.168.200.210:31090/">http://192.168.200.210:31090</a> &#x2F; <a target="_blank" rel="noopener" href="http://192.168.200.211:31090/">http://192.168.200.211:31090/</a> 访问</p>
<p>十二、Kubernetes资源管理</p>
<p>​	在Kubernetes中，一切皆为资源！！</p>
<p>​	资源：pod(容器跑在pod中)、pod控制器(管理pod，分为不同的类型)、service(提供服务访问)、存储(数据持久化)</p>
<p>​	yaml语言：</p>
<p>​	类似于xml、json的标记性语言，强调以数据为中心</p>
<p>​	语法：使用缩进表示层级关系</p>
<p>​				缩进空格的个数不重要，对其即可表示同一层级 </p>
<table>
<thead>
<tr>
<th>#</th>
<th>表示注释</th>
</tr>
</thead>
<tbody><tr>
<td>：</td>
<td>后面加空格</td>
</tr>
</tbody></table>
<p>​	数据类型：</p>
<p>​			纯量：不可再分的值（布尔值、整数、浮点数、null、字符串、时间日期······）</p>
<hr>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img01.656886.xyz/%E5%92%95%E5%92%95.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img01.656886.xyz/%E5%92%95%E5%92%95.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">Fa</div><div class="post-copyright__author_desc">| 发现未知,学习内容</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://blog.656886.xyz/undefined/Docker/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://blog.656886.xyz/undefined/Docker/')">Docker</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://blog.656886.xyz/undefined/Docker/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=Docker&amp;url=http://blog.656886.xyz/undefined/Docker/&amp;pic=https://img01.656886.xyz//docker.jpg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://blog.656886.xyz" target="_blank">F Blog</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E7%AC%94%E8%AE%B0/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>笔记<span class="tagsPageCount">1</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://img01.656886.xyz//docker.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/undefined/%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%BA%94%E7%94%A8%E5%AE%9E%E8%AE%AD/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xunihuashixun.656886.xyz/xunihuajishufengmiantu.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">虚拟化技术与应用实训</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img01.656886.xyz/%E5%92%95%E5%92%95.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description">欢迎来到我的博客！这里是我解决学习中各种小难题与需求的记录空间。<br>感谢你的到访，希望你在这里能找到你需要的知识和教程。</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">Fa</h1><div class="author-info__desc">| 发现未知,学习内容</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/Fa277322" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://t.me/ikunkunkun666" target="_blank" title="Telegram"><i class="anzhiyufont anzhiyu-icon-paper-plane"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker"><span class="toc-text">Docker</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E3%80%81docker%E6%A6%82%E8%BF%B0"><span class="toc-text">一、docker概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-text">二、实验环境搭建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E9%95%9C%E5%83%8F%E5%92%8C%E5%AE%B9%E5%99%A8"><span class="toc-text">三、镜像和容器</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%95%9C%E5%83%8F"><span class="toc-text">镜像:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8%EF%BC%9A"><span class="toc-text">容器：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="toc-text">四、数据卷</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C"><span class="toc-text">五、容器网络</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C"><span class="toc-text">六、镜像制作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E4%BB%93%E5%BA%93"><span class="toc-text">七、仓库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%AB%E3%80%81docker-swarm"><span class="toc-text">八、docker swarm</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B9%9D%E3%80%81docker-compose"><span class="toc-text">九、docker-compose</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%81%E3%80%81docker%E5%8F%AF%E8%A7%86%E5%8C%96%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7"><span class="toc-text">十、docker可视化管理工具</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81Kubernetes%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85"><span class="toc-text">十一、Kubernetes简介与安装</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/undefined/Docker/" title="Docker"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img01.656886.xyz//docker.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Docker"/></a><div class="content"><a class="title" href="/undefined/Docker/" title="Docker">Docker</a><time datetime="2025-05-27T16:00:00.000Z" title="发表于 2025-05-28 00:00:00">2025-05-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/undefined/%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%BA%94%E7%94%A8%E5%AE%9E%E8%AE%AD/" title="虚拟化技术与应用实训"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xunihuashixun.656886.xyz/xunihuajishufengmiantu.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="虚拟化技术与应用实训"/></a><div class="content"><a class="title" href="/undefined/%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%BA%94%E7%94%A8%E5%AE%9E%E8%AE%AD/" title="虚拟化技术与应用实训">虚拟化技术与应用实训</a><time datetime="2024-12-26T10:00:00.000Z" title="发表于 2024-12-26 18:00:00">2024-12-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/undefined/Windows%20Server%202022%20FTP%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E4%BD%BF%E7%94%A8/" title="Windows Server 2022 FTP服务器的搭建与使用"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img05.656886.xyz/FTP.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Windows Server 2022 FTP服务器的搭建与使用"/></a><div class="content"><a class="title" href="/undefined/Windows%20Server%202022%20FTP%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E4%BD%BF%E7%94%A8/" title="Windows Server 2022 FTP服务器的搭建与使用">Windows Server 2022 FTP服务器的搭建与使用</a><time datetime="2024-11-30T10:00:00.000Z" title="发表于 2024-11-30 18:00:00">2024-11-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/undefined/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E7%AC%94%E8%AE%B0/" title="内网穿透"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img03.656886.xyz/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="内网穿透"/></a><div class="content"><a class="title" href="/undefined/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E7%AC%94%E8%AE%B0/" title="内网穿透">内网穿透</a><time datetime="2024-11-30T10:00:00.000Z" title="发表于 2024-11-30 18:00:00">2024-11-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/undefined/%E9%85%8D%E7%BD%AEDNS%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%9B%E8%A1%8C%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90+%E9%85%8D%E7%BD%AE%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/" title="配置DNS服务器进行域名解析+配置邮件服务器"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img03.656886.xyz/DNS%2BSMTP.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="配置DNS服务器进行域名解析+配置邮件服务器"/></a><div class="content"><a class="title" href="/undefined/%E9%85%8D%E7%BD%AEDNS%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%9B%E8%A1%8C%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90+%E9%85%8D%E7%BD%AE%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/" title="配置DNS服务器进行域名解析+配置邮件服务器">配置DNS服务器进行域名解析+配置邮件服务器</a><time datetime="2024-11-30T10:00:00.000Z" title="发表于 2024-11-30 18:00:00">2024-11-30</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title="博客框架为Hexo_v5.4.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img01.656886.xyz/hexo-svgrepo-com.svg" alt="博客框架为Hexo_v5.4.0"/></a><a class="github-badge" target="_blank" href="https://blog.anheyu.com/" style="margin-inline:5px" data-title="本站使用AnZhiYu主题" title="本站使用AnZhiYu主题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img01.656886.xyz/rainbow-svgrepo-com.svg" alt="本站使用AnZhiYu主题"/></a><a class="github-badge" target="_blank" href="https://www.cloudflare.com/" style="margin-inline:5px" data-title="本站使用cloudflare为静态资源提供CDN加速" title="本站使用cloudflare为静态资源提供CDN加速"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img01.656886.xyz/cloudflare-svg.svg" alt="本站使用cloudflare为静态资源提供CDN加速"/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title="本站项目由Github托管"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img01.656886.xyz/github-142-svgrepo-com.svg" alt="本站项目由Github托管"/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img01.656886.xyz/creativecommons-svgrepo-com.svg" alt="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"/></a></p></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2024 - 2025 By <a class="footer-bar-link" href="/" title="Fa" target="_blank">Fa</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">7</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">3</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://blog.656886.xyz/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img01.656886.xyz/%E5%92%95%E5%92%95.jpg" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://picgo.github.io/PicGo-Doc/" title="PicGo图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img01.656886.xyz/PicGo-LOGO.svg" alt="PicGo图床"/><span class="back-menu-item-text">PicGo图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 教程TUTORIAL</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 全部文章</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 文章分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 推荐REC</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/%E6%9C%BA%E5%9C%BA%E6%B5%8B%E8%AF%84/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 机场测评</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://ssh.cmliussss.net/"><i class="anzhiyufont anzhiyu-icon-keyboard faa-tada" style="font-size: 0.9em;"></i><span> WebSSH</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 公益服务CSR</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://github.fxxk.dedyn.io/"><i class="anzhiyufont anzhiyu-icon-github faa-tada" style="font-size: 0.9em;"></i><span> GitHub 文件加速</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://ssh.cmliussss.net/"><i class="anzhiyufont anzhiyu-icon-keyboard faa-tada" style="font-size: 0.9em;"></i><span> WebSSH</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://sub.fxxk.dedyn.io/"><i class="anzhiyufont anzhiyu-icon-shuffle faa-tada" style="font-size: 0.9em;"></i><span> 订阅转换</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于F</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-house-chimney faa-tada" style="font-size: 0.9em;"></i><span> About me</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://github.com/Fa277322?tab=repositories"><i class="anzhiyufont anzhiyu-icon-github faa-tada" style="font-size: 0.9em;"></i><span> GitHub仓库</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/%E4%B8%AD%E5%B0%8F%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E6%9E%84%E5%BB%BA/" style="font-size: 0.88rem;">中小企业网络构建<sup>5</sup></a><a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 0.88rem;">笔记<sup>1</sup></a><a href="/tags/%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF/" style="font-size: 0.88rem;">虚拟化技术<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("30/11/2024 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2024 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Fa 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>